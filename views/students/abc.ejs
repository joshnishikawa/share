<%- include('../head.ejs') -%>
<%- include('navbar.ejs') -%>

<div class="container">
  <div class="row">
    <div class="col d-flex flex-wrap">

      <a href="abc/haystack" class="btn btn-light border border-3 border-success shadow m-3" style="width:300px;">
        <h5>Haystack</h5>
        <div class="container text-center UD">
          <div class="row">
            <div class="col p-1">p</div>
            <div class="col p-1"><div class="rounded-3 alert-primary">b</div></div>
            <div class="col p-1">p</div>
            <div class="col p-1">d</div>
            <div class="col p-1">d</div>
            <div class="col p-1"><div class="rounded-3 alert-primary">b</div></div>
          </div>
          <div class="row">
            <div class="col p-1"><div class="rounded-3 alert-primary">b</div></div>
            <div class="col p-1">p</div>
            <div class="col p-1">d</div>
            <div class="col p-1"><div class="rounded-3 alert-primary">b</div></div>
            <div class="col p-1">h</div>
            <div class="col p-1">h</div>
          </div>
          <div class="row">
            <div class="col p-1">d</div>
            <div class="col p-1">h</div>
            <div class="col p-1"><div class="rounded-3 alert-primary">b</div></div>
            <div class="col p-1">p</div>
            <div class="col p-1">h</div>
            <div class="col p-1">d</div>
          </div>
          <div class="row">
            <div class="col p-1">p</div>
            <div class="col p-1">h</div>
            <div class="col p-1">p</div>
            <div class="col p-1">d</div>
            <div class="col p-1"><div class="rounded-3 alert-primary">b</div></div>
            <div class="col p-1">h</div>
          </div>
        </div>

      </a>
      <a href="abc/pairs" class="btn btn-light border border-3 border-success shadow m-3" style="width:300px;">
        <h5>Make Pairs</h5>
        <div class="container text-center UD">
          <div class="row">
            <div class="col p-1"><div class="alert-primary border border-primary rounded-3 shadow w-100 h-100"></div></div>
            <div class="col p-1"><div class="alert-primary border border-primary rounded-3 shadow w-100 h-100"></div></div>
            <div class="col p-1"><div class="alert-primary border border-primary rounded-3 shadow w-100 h-100"></div></div>
            <div class="col p-1"><div class="alert-primary border border-primary rounded-3 shadow w-100 h-100"></div></div>
            <div class="col p-1"><div class="w-100 h-100 rounded-3 shadow">L</div></div>
            <div class="col p-1"><div class="alert-primary border border-primary rounded-3 shadow w-100 h-100"></div></div>
          </div>
          <div class="row">
            <div class="col p-1"><div class="alert-primary border border-primary rounded-3 shadow w-100 h-100"></div></div>
            <div class="col p-1"><div class="alert-primary border border-primary rounded-3 shadow w-100 h-100"></div></div>
            <div class="col p-1"><div class="w-100 h-100 rounded-3 shadow">R</div></div>
            <div class="col p-1"><div class="alert-primary border border-primary rounded-3 shadow w-100 h-100"></div></div>
            <div class="col p-1"><div class="w-100 h-100 rounded-3 shadow">F</div></div>
            <div class="col p-1"><div class="w-100 h-100 rounded-3 shadow">V</div></div>
          </div>
          <div class="row">
            <div class="col p-1"><div class="alert-primary border border-primary rounded-3 shadow w-100 h-100"></div></div>
            <div class="col p-1"><div class="w-100 h-100 rounded-3 shadow">V</div></div>
            <div class="col p-1"><div class="w-100 h-100 rounded-3 shadow">R</div></div>
            <div class="col p-1"><div class="alert-primary border border-primary rounded-3 shadow w-100 h-100"></div></div>
            <div class="col p-1"><div class="alert-primary border border-primary rounded-3 shadow w-100 h-100"></div></div>
            <div class="col p-1"><div class="alert-primary border border-primary rounded-3 shadow w-100 h-100"></div></div>
          </div>
          <div class="row">
            <div class="col p-1"><div class="w-100 h-100 rounded-3 shadow">L</div></div>
            <div class="col p-1"><div class="alert-primary border border-primary rounded-3 shadow w-100 h-100"></div></div>
            <div class="col p-1"><div class="w-100 h-100 rounded-3 shadow">F</div></div>
            <div class="col p-1"><div class="alert-primary border border-primary rounded-3 shadow w-100 h-100"></div></div>
            <div class="col p-1"><div class="alert-primary border border-primary rounded-3 shadow w-100 h-100"></div></div>
            <div class="col p-1"><div class="alert-primary border border-primary rounded-3 shadow w-100 h-100"></div></div>
          </div>
        </div>
      </a>

      <div  class="btn btn-light border border-3 border-success shadow m-3" style="width:300px;">
        <h5>SRS</h5>
        <div id="progress" class="radial-progress-bar shadow">
          <div class="right-half"></div>
          <div class="left-half-mask"></div>
          <div class="left-half"></div>
          <div class="inner-circle"></div>
        </div>
        <button id="startSRS" class="btn btn-success">Start</button>
        <button id="resetSRS" class="btn btn-danger" style="display:none;">Reset</button>
      </div>

    </div>
  </div>
</div>


<script src="https://members.englishjones.com/javascripts/study_utilities.js"></script>

<script>
$(function(){
  $(`#abc-tab`).addClass("active");

  let ranks = [];

  // get ranks from cookie
  let cookie = document.cookie.split(';').find(row => row.startsWith('ranks='));
  if(cookie){
    console.log('cookie');
    cookie = cookie.split('=')[1];
    ranks = cookie.split(',').map(x=>parseInt(x));
  }
  else {
    ranks = [0];
  }

  // get sum of ranks
  let sum = ranks.reduce((a,b)=>a+b, 0);
  let percent = Math.round(sum / (ranks.length * 5) * 100);
  if (percent >= 100){
    $("#startSRS").prop('disabled', true);
    $("#resetSRS").show();
  }

  progressToPercent(ranks, 0); //do this after you calculate aim

  $("#startSRS").on('click', ()=>{
    window.location.href = "abc/srs";
  });

  $("#resetSRS").on('click', ()=>{
    $.post("/abc/reset", (data)=>{
      if (data == "success"){
        document.cookie = "ranks=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
        window.location.reload();
      }
    });
  });

});
</script>

<%- include('../foot.ejs') -%>
